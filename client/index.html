<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Collaborative Canvas</title>

    <!-- Bootstrap CSS  -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />

    <!-- CSS -->
    <link rel="stylesheet" href="./style.css" />
  </head>

  <body>
    <!-- Navbar -->
    <nav
      class="navbar navbar-light bg-white border-bottom px-3 position-relative"
    >
      <!-- Center Title -->
      <div class="position-absolute top-50 start-50 translate-middle">
        <span class="navbar-brand mb-0 fw-bold titleBig"
          >Collaborative Canvas</span
        >
      </div>

      <!-- Join Right -->
      <div class="ms-auto d-flex gap-2">
        <input
          id="nameInput"
          class="form-control form-control-sm"
          style="width: 200px"
          placeholder="Your name"
        />
        <button id="joinBtn" class="btn btn-primary btn-sm">Join</button>
      </div>
    </nav>

    <!-- Tools Panel -->
    <div id="toolsPanel" class="card shadow-sm draggable">
      <div class="card-body">
        <h6 class="fw-bold mb-2">Tools</h6>

        <div class="btn-group w-100 mb-3" role="group">
          <button
            id="brushBtn"
            class="btn btn-outline-dark btn-sm activeTool"
            title="Brush"
          >
            <i class="bi bi-brush"></i>
          </button>
          <button
            id="eraserBtn"
            class="btn btn-outline-dark btn-sm"
            title="Eraser"
          >
            <i class="bi bi-eraser"></i>
          </button>
        </div>

        <div class="mb-2">
          <label class="form-label fw-semibold mb-1">Colors</label>

          <!-- Palette -->
          <div id="colorPalette" class="d-flex flex-wrap gap-2 mb-2"></div>

          <!-- Selected preview + picker -->
          <div class="d-flex align-items-center gap-2">
            <div
              id="selectedColorPreview"
              class="border rounded"
              style="width: 28px; height: 28px"
            ></div>

            <input
              type="color"
              id="colorPicker"
              class="form-control form-control-color"
              value="#111111"
            />

            <span class="small text-muted">Custom</span>
          </div>
        </div>

        <div class="mb-3 mt-3">
          <label class="form-label fw-semibold mb-1">Stroke Width</label>
          <div class="d-flex align-items-center gap-2">
            <input
              type="range"
              id="widthSlider"
              class="form-range"
              min="1"
              max="40"
              value="6"
            />
            <span id="widthValue" class="badge bg-dark">6</span>
          </div>
        </div>

        <hr />

        <h6 class="fw-bold mb-2">History</h6>
        <div class="d-flex gap-2">
          <button
            id="undoBtn"
            class="btn btn-warning btn-sm w-50"
            title="Undo (Ctrl+Z)"
          >
            <i class="bi bi-arrow-counterclockwise"></i> Undo
          </button>
          <button
            id="redoBtn"
            class="btn btn-success btn-sm w-50"
            title="Redo (Ctrl+Y)"
          >
            <i class="bi bi-arrow-clockwise"></i> Redo
          </button>
        </div>
      </div>
    </div>

    <!-- Users Panel -->
    <div id="usersPanel" class="card shadow-sm draggable">
      <div class="card-body">
        <h6 class="fw-bold mb-3">Online</h6>
        <ul id="usersList" class="list-group list-group-flush"></ul>
      </div>
    </div>

    <!-- Canvas -->
    <canvas id="board"></canvas>

    <!-- Status Bar -->
    <div id="statusBar" class="shadow-sm">
      <div id="statusLeft">ðŸ”´ Disconnected</div>
      <div id="statusCenter">Tool: Brush | Width: 6 | Color: #111111</div>
      <div id="statusRight">Users: 0</div>
    </div>

    <div id="brushCursor"></div>
    <div id="statusFPS">FPS: --</div>

    <!-- Socket.io client (must load BEFORE main.js) -->
    <script src="/socket.io/socket.io.js"></script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Main JS -->
    <script type="module" src="./main.js"></script>

    <!-- Toast Container -->
    <div
      class="toast-container position-fixed top-0 end-0 p-3"
      style="z-index: 9999"
    >
      <div
        id="appToast"
        class="toast align-items-center text-bg-dark border-0"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
      >
        <div class="d-flex">
          <div class="toast-body" id="toastBody">Hello!</div>
          <button
            type="button"
            class="btn-close btn-close-white me-2 m-auto"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
      </div>
    </div>
  </body>
</html>
